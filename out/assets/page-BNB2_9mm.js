import{r as a,n as U,j as e,L as d,q as v,t as A,w as p,d as k,e as N,f as D,l as H,m as I}from"./index-C6PY5QRv.js";import{H as M,B as m,F}from"./Footer-BepvwvVu.js";import{C as g}from"./Card-D3mEm6qj.js";import{B as z}from"./Badge-B-7gq-4s.js";function O(){const[E,b]=a.useState(!0),[S,B]=a.useState(""),[n,R]=a.useState(0),[x,h]=a.useState("green"),[q,f]=a.useState(""),[l,L]=a.useState([]),{user:i}=U(),[$,C]=a.useState([]);a.useEffect(()=>{if(!i||l.length===0)return;const s=new Date(l[0].preferredDate),t=new Date(s);t.setDate(t.getDate()+90),B(t.toLocaleDateString());const r=new Date,c=t.getTime()-r.getTime(),o=Math.ceil(c/(1e3*3600*24));R(o)},[l,i]),console.log("donationHistory",l),a.useEffect(()=>{(async()=>{if(!i)return;const t=v(k(N,"donations"),p("donorId","==",i.uid),p("status","==","completed"),A("lastDonation","desc")),r=await D(t);if(!r.empty){const c=[];r.forEach(o=>{c.push({id:o.id,...o.data()})}),L(c)}b(!1)})()},[i]),console.log("current user uid:",i.uid),a.useEffect(()=>{n<=0?(h("green"),f("You can donate again now!")):n<=14?(h("red"),f(`You can donate again in ${n} days.`)):n<=45?(h("yellow"),f(`You can donate again in ${n} days.`)):(h("green"),f(`You can donate again in ${n} days.`)),b(!1)},[n]),a.useEffect(()=>{(async()=>{const t=v(k(N,"blood_requests"),p("status","==","pending")),r=await D(t);if(!r.empty){const c=[];for(const o of r.docs){const j=o.data();let y="";if(j.location){const Y=H(N,"blood_banks",j.location),w=await I(Y);if(w.exists()){const u=w.data();y=u.name||u.fullName||u.bloodBankName||u.bankName||""}}c.push({id:o.id,...j,locationName:y})}C(c)}})()},[]);const T=s=>{switch(s){case"emergency":return{variant:"danger",text:"EMERGENCY",icon:"ri-alarm-warning-line"};case"urgent":return{variant:"warning",text:"URGENT",icon:"ri-time-line"};case"routine":return{variant:"success",text:"ROUTINE",icon:"ri-calendar-line"};default:return{variant:"default",text:s.toUpperCase(),icon:"ri-information-line"}}};return E?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-pink-50/30 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-pink-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4 animate-pulse",children:e.jsx("i",{className:"ri-heart-pulse-fill text-white text-2xl"})}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):i?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-pink-50/30",children:[e.jsx(M,{}),e.jsx("section",{className:"bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-white pt-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-6",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsxs("h1",{className:"text-4xl sm:text-5xl font-bold mb-3 leading-tight",children:["Welcome back ",(i.fullName||i.firstName||i.displayName||"").toString().replace(/\b\w/g,s=>s.toUpperCase()),"!"]}),e.jsx("p",{className:"text-pink-100 text-lg max-w-md mx-auto md:mx-0",children:"Thank you for being a life-saving donor. Your contributions make a real difference."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 self-center md:self-start",children:[e.jsx(d,{to:"/donate",className:"w-full sm:w-auto",children:e.jsxs(m,{className:"w-full sm:w-auto bg-white text-pink-600 hover:bg-gray-50 px-6 py-4 text-lg",children:[e.jsx("i",{className:"ri-gift-line mr-2"}),"Donate Now"]})}),e.jsx(d,{to:"/profile",className:"w-full sm:w-auto",children:e.jsxs(m,{className:"w-full sm:w-auto bg-white/20 border border-white/30 text-white hover:bg-white/30 px-6 py-4 text-lg",children:[e.jsx("i",{className:"ri-user-line mr-2"}),"Edit Profile"]})})]})]})})}),e.jsx("section",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(g,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Blood Requests "}),e.jsx(d,{to:"",children:e.jsx(m,{size:"sm",variant:"outline",children:"View All"})})]}),e.jsx("div",{className:"space-y-4",children:$.map(s=>{const t=T(s.urgency);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-drop-line text-pink-500"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900",children:[s.bloodType," Blood Needed"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.unitsNeeded," Pints required"]})]})]}),e.jsxs(z,{variant:t.variant,children:[e.jsx("i",{className:`${t.icon} mr-1`}),t.text]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.medicalCondition}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-map-pin-line mr-1"}),s.locationName]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-time-line mr-1"}),s.createdAt?.toDate().toLocaleString()]})]}),e.jsx("div",{className:"mt-4 flex space-x-2"})]},s.id)})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(g,{className:`bg-gradient-to-r from-${x}-50 to-${x}-50 text-white border-${x}-200`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 bg-${x}-500 rounded-full flex items-center justify-center`,children:e.jsx("i",{className:"ri-calendar-check-line text-white text-xl"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-black",children:"Next Donation Eligible"}),e.jsx("p",{className:"text-black font-medium",children:S}),e.jsx("p",{className:`text-sm ${x==="red"?"text-red-100":x==="yellow"?"text-black":"text-green-700"}`,children:q})]})]})}),e.jsxs(g,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Recent Donations"}),l.length>4&&e.jsx(d,{to:"/profile",children:e.jsx(m,{size:"sm",variant:"outline",children:"View All"})})]}),e.jsxs("div",{className:"space-y-4",children:[l.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"You havenâ€™t made any donations yet."}),l.slice(0,3).map(s=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-drop-line text-pink-500 text-sm"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Blood Donation"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.bloodType," "]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.preferredDate})})]},s.id))]})]})]})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(g,{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(d,{to:"/donate",children:e.jsxs(m,{className:"w-full bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600",children:[e.jsx("i",{className:"ri-gift-line mr-2"}),"Schedule Donation"]})}),e.jsx(d,{to:"/blood-banks",children:e.jsxs(m,{variant:"outline",className:"w-full",children:[e.jsx("i",{className:"ri-hospital-line mr-2"}),"Find Blood Banks"]})}),e.jsx(d,{to:"/request",children:e.jsxs(m,{variant:"outline",className:"w-full",children:[e.jsx("i",{className:"ri-search-line mr-2"}),"Request Blood"]})})]})]})})]})}),e.jsx(F,{})]}):null}export{O as default};
//# sourceMappingURL=page-BNB2_9mm.js.map
