{"version":3,"mappings":"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","names":["Auth","notify","useNotification","activeTab","setActiveTab","useState","authMode","setAuthMode","isLoading","setIsLoading","showSuccess","setShowSuccess","navigate","useNavigate","formData","setFormData","bloodTypes","useEffect","currentUser","user","handleInputChange","e","validateForm","handleSubmit","resolve","uid","firebaseSignIn","userDoc","getUserProfile","raw","rawType","normalizedType","userData","expectedType","n","m","err","userProfileData","bloodBankData","signUpBloodBank","userCredential","signUpDonorProfile","newUid","createdDoc","normalized","jsxs","jsx","Header","Card","Fragment","Button","type","Link","Footer"],"ignoreList":[],"sources":["../../src/pages/auth/page.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport Header from '../../components/feature/Header';\nimport Footer from '../../components/feature/Footer';\nimport Button from '../../components/base/Button';\nimport Card from '../../components/base/Card';\nimport { signUpDonorProfile, signUpBloodBank, signIn as firebaseSignIn } from '../../firebase/auth';\nimport { getUserProfile } from '../../firebase/services';\nimport { useNotification } from \"../../context/NotificationContext\";\n\nexport default function Auth() {\n  const { notify } = useNotification();\n\n  const [activeTab, setActiveTab] = useState<'donor' | 'bloodbank'>('donor');\n  const [authMode, setAuthMode] = useState<'login' | 'signup'>('login');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const navigate = useNavigate();\n  \n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    firstName: '',\n    lastName: '',\n    phone: '',\n    bloodType: '',\n    dateOfBirth: '',\n    organizationName: '',\n    licenseNumber: '',\n    address: ''\n  });\n\n  const bloodTypes = ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'];\n\n  // Check if user is already logged in\n  useEffect(() => {\n    const currentUser = localStorage.getItem('bloodlink_user');\n    if (currentUser) {\n      const user = JSON.parse(currentUser);\n      if (user.type === 'donor') {\n        navigate('/donor/dashboard');\n      } else if (user.type === 'bloodbank') {\n        navigate('/blood-banks/dashboard');\n      }\n    }\n  }, [navigate]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const validateForm = () => {\n    if (authMode === 'signup') {\n      if (activeTab === 'donor') {\n        if (!formData.firstName || !formData.lastName || !formData.email || !formData.password || !formData.confirmPassword) {\n          notify({ type:\"error\", message:\"Please fill in all required fields\" });\n          return false;\n        }\n        if (formData.password !== formData.confirmPassword) {\n          notify({ type:\"error\", message:\"Passwords do not match\" });\n          return false;\n        }\n        if (formData.password.length < 6) {\n          notify({ type:\"error\", message:\"Password must be at least 6 characters long\" });\n          return false;\n        }\n      } else {\n        if (!formData.organizationName || !formData.licenseNumber || !formData.address || !formData.email || !formData.phone) {\n          notify({ type:\"error\", message:\"Please fill in all required fields\" });\n          return false;\n        }\n      }\n    } else {\n      if (!formData.email || !formData.password) {\n        notify({ type:\"error\", message:\"Please enter your email and password\" });\n        return false;\n      }\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n\n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 1500));\n\n    if (authMode === 'login') {\n      try {\n        const userCredential = await firebaseSignIn(formData.email, formData.password);\n        const uid = userCredential.user.uid;\n\n        const userDoc = await getUserProfile(uid);\n        if (!userDoc.exists()) {\n          // If profile missing, sign out and show error\n          notify({ type:\"error\", message:\"User profile not found. Please contact support.\" });\n          return;\n        }\n\n        const raw = userDoc.data() as any;\n        const rawType = (raw.userType || raw.type || '').toString();\n        const normalizedType = rawType.toLowerCase().includes('blood') ? 'bloodbank' : rawType.toLowerCase().includes('admin') ? 'superadmin' : 'donor';\n        const userData = {\n          id: uid,\n          // keep original fields\n          ...raw,\n          // normalized type and name fields for UI\n          type: normalizedType,\n          firstName: raw.firstName || (raw.fullName ? raw.fullName.split(' ')[0] : ''),\n          lastName: raw.lastName || (raw.fullName ? raw.fullName.split(' ').slice(1).join(' ') : ''),\n        };\n        // Ensure the selected login tab matches the user's role to prevent role spoofing\n        const expectedType = activeTab === 'donor' ? 'donor' : 'bloodBank';\n        if (userData.userType !== expectedType && userData.userType !== 'superAdmin') {\n          // Sign out the user to be safe\n          try {\n            // firebaseSignIn already signed them in; sign them out\n            await import('../../firebase/auth').then(m => m.signOut());\n          } catch (e) {\n            console.warn('Error signing out after role mismatch', e);\n          }\n          notify({ \n            type:\"error\", \n            message:`You are signing in as ${activeTab === 'donor' ? 'Donor' : 'Blood Bank'}. Your account is registered as ${userData.userType}. Please choose the correct login type.`  \n          });\n          setIsLoading(false);\n          return;\n        }\n        localStorage.setItem('bloodlink_user', JSON.stringify(userData));\n        // token stored by Firebase; keep a simple marker\n        localStorage.setItem('bloodlink_auth_token', 'firebase_auth_' + Date.now());\n\n        // Redirect based on user type\n        if (userData.userType === 'donor') {\n          navigate('/donor/dashboard');\n        } else if (userData.userType === 'bloodBank') {\n          navigate('/blood-banks/dashboard');\n        } else if (userData.userType === 'superAdmin') {\n          navigate('/admin/dashboard');\n        } else {\n          navigate('/');\n        }\n      } catch (err: any) {\n        console.error('Login error', err);\n        notify({ type:\"error\", message: err?.message || 'Login failed' });\n      }\n    } else {\n        try {\n          if (activeTab === 'bloodbank') {\n            // Create blood bank user and documents\n            const userProfileData = {\n              fullName: formData.organizationName || '',\n              email: formData.email,\n              userType: 'bloodBank',\n              phone: formData.phone || '',\n              address: formData.address || ''\n            };\n\n            const bloodBankData = {\n              name: formData.organizationName || '',\n              address: formData.address || '',\n              licenseNumber: formData.licenseNumber || '',\n              contactEmail: formData.email,\n              contactPhone: formData.phone || '',\n              approved: false,\n              inventory: {},\n            };\n\n            await signUpBloodBank(formData.email, formData.password, userProfileData as any, bloodBankData as any);\n            setShowSuccess(true);\n            setTimeout(() => {\n              setAuthMode('login');\n              setShowSuccess(false);\n              setFormData({\n                email: '',\n                password: '',\n                confirmPassword: '',\n                firstName: '',\n                lastName: '',\n                phone: '',\n                bloodType: '',\n                dateOfBirth: '',\n                organizationName: '',\n                licenseNumber: '',\n                address: ''\n              });\n            }, 3000);\n          } else {\n            // Donor signup with Firestore profile\n            const userProfileData = {\n              fullName: `${formData.firstName} ${formData.lastName}`,\n              email: formData.email,\n              userType: 'donor',\n              phone: formData.phone || '',\n              address: ''\n            };\n\n            // Create Auth user and Firestore profile\n            const userCredential = await signUpDonorProfile(formData.email, formData.password, userProfileData as any);\n            // Normalize and store profile in localStorage so dashboards can read it\n            try {\n              const newUid = userCredential.user.uid;\n              const createdDoc = await getUserProfile(newUid);\n              const raw = createdDoc.exists() ? (createdDoc.data() as any) : userProfileData;\n              const rawType = (raw.userType || raw.type || '').toString();\n              const normalizedType = rawType.toLowerCase().includes('blood') ? 'bloodbank' : rawType.toLowerCase().includes('admin') ? 'superadmin' : 'donor';\n              const normalized = {\n                id: newUid,\n                ...raw,\n                type: normalizedType,\n                firstName: raw.firstName || (raw.fullName ? raw.fullName.split(' ')[0] : formData.firstName),\n                lastName: raw.lastName || (raw.fullName ? raw.fullName.split(' ').slice(1).join(' ') : formData.lastName),\n              };\n              localStorage.setItem('bloodlink_user', JSON.stringify(normalized));\n              localStorage.setItem('bloodlink_auth_token', 'firebase_auth_' + Date.now());\n            } catch (e) {\n              console.warn('Failed to persist created user to localStorage', e);\n            }\n\n            navigate('/profile');\n          }\n        } catch (err: any) {\n          console.error('Signup error', err);\n          notify({ type:\"error\", message: err?.message || \"Signup failed.\" });\n        }\n    }\n\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-pink-50/20 relative overflow-hidden\">\n      {/* Animated Background Elements */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-pink-400/10 to-purple-400/10 rounded-full blur-3xl animate-float\"></div>\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-blue-400/10 to-pink-400/10 rounded-full blur-3xl animate-float\" style={{ animationDelay: '-2s' }}></div>\n      </div>\n\n      <Header />\n      \n      <section className=\"py-20 relative z-10\">\n        <div className=\"max-w-md mx-auto px-4 sm:px-6 lg:px-8\">\n          {/* Header Section */}\n          <div className=\"text-center mb-12\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-pink-500 to-purple-500 rounded-2xl shadow-lg shadow-pink-500/20 mb-6\">\n              <i className=\"ri-heart-pulse-fill text-white text-2xl\"></i>\n            </div>\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-3\">\n              {authMode === 'login' ? 'Welcome Back' : 'Join BloodLink'}\n            </h1>\n            <p className=\"text-gray-600 leading-relaxed\">\n              {authMode === 'login' \n                ? 'Sign in to your account to continue saving lives'\n                : 'Create your account and start making a difference'\n              }\n            </p>\n          </div>\n\n          {/* Main Auth Card */}\n          <Card className=\"shadow-xl border-0 bg-white/90 backdrop-blur-sm relative overflow-hidden\">\n            {/* Decorative top border */}\n            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 to-purple-500\"></div>\n\n            {authMode === 'login' ? (\n              <>\n                {/* User Type Selection for Login */}\n                <div className=\"flex mb-6 p-1 bg-gray-100 rounded-xl\">\n                  <button\n                    onClick={() => setActiveTab('donor')}\n                    className={`flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200 whitespace-nowrap ${\n                      activeTab === 'donor'\n                        ? 'bg-white text-pink-600 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-800'\n                    }`}\n                  >\n                    <i className=\"ri-user-heart-line mr-2\"></i>\n                    Donor/User\n                  </button>\n                  <button\n                    onClick={() => setActiveTab('bloodbank')}\n                    className={`flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200 whitespace-nowrap ${\n                      activeTab === 'bloodbank'\n                        ? 'bg-white text-pink-600 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-800'\n                    }`}\n                  >\n                    <i className=\"ri-hospital-line mr-2\"></i>\n                    Blood Bank\n                  </button>\n                </div>\n\n                {/* Login Form */}\n                <form onSubmit={handleSubmit} className=\"space-y-5\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Email Address\n                    </label>\n                    <input\n                      type=\"email\"\n                      name=\"email\"\n                      value={formData.email}\n                      onChange={handleInputChange}\n                      className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm transition-all duration-200 bg-white\"\n                      placeholder=\"Enter your email\"\n                      required\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Password\n                    </label>\n                    <input\n                      type=\"password\"\n                      name=\"password\"\n                      value={formData.password}\n                      onChange={handleInputChange}\n                      className=\"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm transition-all duration-200 bg-white\"\n                      placeholder=\"Enter your password\"\n                      required\n                    />\n                  </div>\n\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full whitespace-nowrap bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg hover:shadow-pink-500/30 text-white font-semibold py-3\" \n                    disabled={isLoading}\n                  >\n                    {isLoading ? (\n                      <>\n                        <i className=\"ri-loader-4-line mr-2 animate-spin\"></i>\n                        Signing In...\n                      </>\n                    ) : (\n                      <>\n                        <i className=\"ri-login-box-line mr-2\"></i>\n                        Sign In\n                      </>\n                    )}\n                  </Button>\n\n                  <div className=\"text-center pt-4\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setAuthMode('signup')}\n                      className=\"text-pink-500 hover:text-pink-600 text-sm font-medium cursor-pointer transition-colors duration-200\"\n                    >\n                      Don't have an account? Sign up here\n                    </button>\n                  </div>\n                </form>\n              </>\n            ) : (\n              <>\n                {/* Tab Switcher for Signup */}\n                <div className=\"flex mb-6 p-1 bg-gray-100 rounded-xl\">\n                  <button\n                    onClick={() => setActiveTab('donor')}\n                    className={`flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200 whitespace-nowrap ${\n                      activeTab === 'donor'\n                        ? 'bg-white text-pink-600 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-800'\n                    }`}\n                  >\n                    <i className=\"ri-user-heart-line mr-2\"></i>\n                    Donor/User\n                  </button>\n                  <button\n                    onClick={() => setActiveTab('bloodbank')}\n                    className={`flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200 whitespace-nowrap ${\n                      activeTab === 'bloodbank'\n                        ? 'bg-white text-pink-600 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-800'\n                    }`}\n                  >\n                    <i className=\"ri-hospital-line mr-2\"></i>\n                    Blood Bank\n                  </button>\n                </div>\n\n                {/* Success Message */}\n                {showSuccess && (\n                  <div className=\"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl\">\n                    <div className=\"flex items-center\">\n                      <div className=\"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3\">\n                        <i className=\"ri-check-line text-white text-sm\"></i>\n                      </div>\n                      <div>\n                        <h4 className=\"font-semibold text-green-800 text-sm\">Registration Submitted!</h4>\n                        <p className=\"text-green-700 text-xs\">You'll receive login credentials once approved.</p>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Signup Forms */}\n                {activeTab === 'donor' ? (\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          First Name *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={formData.firstName}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Last Name *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={formData.lastName}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Email Address *\n                      </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={formData.email}\n                        onChange={handleInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                        required\n                      />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Password *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={formData.password}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Confirm Password *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"confirmPassword\"\n                          value={formData.confirmPassword}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Blood Type\n                        </label>\n                        <select\n                          name=\"bloodType\"\n                          value={formData.bloodType}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 pr-8 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                        >\n                          <option value=\"\">Select type</option>\n                          {bloodTypes.map((type) => (\n                            <option key={type} value={type}>{type}</option>\n                          ))}\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Phone Number\n                        </label>\n                        <input\n                          type=\"tel\"\n                          name=\"phone\"\n                          value={formData.phone}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                        />\n                      </div>\n                    </div>\n\n                    <Button \n                      type=\"submit\" \n                      className=\"w-full whitespace-nowrap bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg text-white font-semibold py-3\" \n                      disabled={isLoading}\n                    >\n                      {isLoading ? (\n                        <>\n                          <i className=\"ri-loader-4-line mr-2 animate-spin\"></i>\n                          Creating Account...\n                        </>\n                      ) : (\n                        <>\n                          <i className=\"ri-user-add-line mr-2\"></i>\n                          Create Account\n                        </>\n                      )}\n                    </Button>\n\n                    <div className=\"text-center pt-4\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setAuthMode('login')}\n                        className=\"text-pink-500 hover:text-pink-600 text-sm font-medium cursor-pointer transition-colors duration-200\"\n                      >\n                        Already have an account? Sign in\n                      </button>\n                    </div>\n                  </form>\n                ) : (\n                  <div>\n                    <div className=\"text-center mb-6\">\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                        Blood Bank Registration\n                      </h3>\n                      <p className=\"text-gray-600 text-sm\">\n                        Registration requires offline verification for security\n                      </p>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"space-y-5\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Facility Name *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"organizationName\"\n                          value={formData.organizationName}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          License Number *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"licenseNumber\"\n                          value={formData.licenseNumber}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Address *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"address\"\n                          value={formData.address}\n                          onChange={handleInputChange}\n                          className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                          required\n                        />\n                      </div>\n                      \n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Email *\n                          </label>\n                          <input\n                            type=\"email\"\n                            name=\"email\"\n                            value={formData.email}\n                            onChange={handleInputChange}\n                            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                            required\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Phone *\n                          </label>\n                          <input\n                            type=\"tel\"\n                            name=\"phone\"\n                            value={formData.phone}\n                            onChange={handleInputChange}\n                            className=\"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 text-sm\"\n                            required\n                          />\n                        </div>\n                      </div>\n                      \n                      <Button \n                        type=\"submit\" \n                        className=\"w-full whitespace-nowrap bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 shadow-lg text-white font-semibold py-3\"\n                        disabled={isLoading}\n                      >\n                        {isLoading ? (\n                          <>\n                            <i className=\"ri-loader-4-line mr-2 animate-spin\"></i>\n                            Submitting...\n                          </>\n                        ) : (\n                          <>\n                            <i className=\"ri-send-plane-fill mr-2\"></i>\n                            Submit Application\n                          </>\n                        )}\n                      </Button>\n                    </form>\n\n                    <div className=\"text-center pt-4\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setAuthMode('login')}\n                        className=\"text-pink-500 hover:text-pink-600 text-sm font-medium cursor-pointer transition-colors duration-200\"\n                      >\n                        Already registered? Sign in\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n          </Card>\n\n          {/* Back to Home Link */}\n          <div className=\"text-center mt-8\">\n            <Link to=\"/\" className=\"inline-flex items-center text-gray-500 hover:text-pink-500 text-sm font-medium transition-colors duration-200\">\n              <i className=\"ri-arrow-left-line mr-2\"></i>\n              Back to BloodLink Home\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      <Footer />\n    </div>\n  );\n}"],"file":"assets/page-D12tzNbF.js"}