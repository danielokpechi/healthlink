{"version":3,"file":"page-Dh9y8-2O.js","sources":["../../src/pages/blood-banks/page.tsx"],"sourcesContent":["\nimport { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport Header from '../../components/feature/Header';\nimport Footer from '../../components/feature/Footer';\nimport Button from '../../components/base/Button';\nimport Card from '../../components/base/Card';\nimport Badge from '../../components/base/Badge';\nimport { collection, getDocs, query, where } from \"firebase/firestore\";\nimport { db } from \"../../firebase\";\nimport bloodBankImg from '../../assets/images/blood-bank.jpg';\n\nexport default function BloodBanks() {\n  const [searchLocation, setSearchLocation] = useState('');\n  const [selectedBloodType, setSelectedBloodType] = useState('');\n  const [sortBy, setSortBy] = useState('distance');\n  const [filteredBanks, setFilteredBanks] = useState<any[]>([]);\n  \n  const bloodTypes = ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'];\n  \n  const [bloodBanks, setBloodBanks] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchBanks = async () => {\n      const q = query(\n        collection(db, \"blood_banks\"),\n        where(\"approved\", \"==\", true)\n      );\n\n      const snapshot = await getDocs(q);\n\n      const banks:any[] = [];\n\n      for (const docSnap of snapshot.docs) {\n      const bankData:any = { id: docSnap.id, ...docSnap.data() };\n\n      const invRef = collection(db, \"blood_banks\", docSnap.id, \"inventory\");\n      const invSnap = await getDocs(invRef);\n\n      const availability:any = {};\n      let lowestPrice = Infinity;\n\n      invSnap.forEach(invDoc => {\n        const data:any = invDoc.data();\n\n        const type = invDoc.id;\n\n        availability[type] = {\n          quantity: data.quantity,\n          price: data.price,\n          available: data.available\n        };\n\n        if (data.price && data.price < lowestPrice) {\n          lowestPrice = data.price;\n        }\n      });\n\n      bankData.availability = availability;\n      bankData.amountPerPint = lowestPrice === Infinity ? null : lowestPrice;\n\n      banks.push(bankData);\n    }\n\n      setBloodBanks(banks);\n      setFilteredBanks(banks);\n    };\n\n    fetchBanks();\n  }, []);\n\n  useEffect(() => {\n    let filtered = [...bloodBanks];\n\n    if (searchLocation.trim() !== \"\") {\n      filtered = filtered.filter(bank =>\n        bank.address.toLowerCase().includes(searchLocation.toLowerCase()) ||\n        bank.name.toLowerCase().includes(searchLocation.toLowerCase())\n      );\n    }\n\n    // filter by blood type selected\n    if (selectedBloodType.trim() !== \"\") {\n      filtered = filtered.filter(bank => {\n        return bank.availability && bank.availability[selectedBloodType]?.available === true;\n      });\n    }\n\n    // sort by availability\n    if (sortBy === \"availability\") {\n      filtered = filtered.filter(bank => {\n        return Object.values(bank.availability).some((val: any) => val.available === true);\n      });\n\n      filtered = filtered.sort((a, b) => {\n        const bCount: number = Object.values(b.availability).reduce((acc: number, val: any) => acc + (val.available ? 1 : 0), 0);\n        const aCount: number = Object.values(a.availability).reduce((acc: number, val: any) => acc + (val.available ? 1 : 0), 0);\n        return bCount - aCount;\n      });\n    }\n    setFilteredBanks(filtered);\n\n  }, [searchLocation, selectedBloodType, sortBy, bloodBanks]);\n  \n  const getStockLevel = (count: number) => {\n    if (count < 5) return { level: 'critical', color: 'danger' };\n    if (count < 10) return { level: 'low', color: 'warning' };\n    return { level: 'good', color: 'success' };\n  };\n  \n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Header />\n      \n      {/* Page Header */}\n      <section className=\"bg-white border-b border-gray-200 mt-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"text-center\">\n            <h1 className=\"text-3xl md:text-4xl font-bold text-gray-900 mb-4\">\n              Blood Banks\n            </h1>\n            <p className=\"text-gray-600 max-w-2xl mx-auto\">\n              View blood banks in your area and check real-time availability of blood types. \n              Find the nearest facility for your donation or blood request needs.\n            </p>\n          </div>\n        </div>\n      </section>\n      \n      {/* Search and Filters */}\n      <section className=\"py-8 bg-white\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <Card>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Location</label>\n                <div className=\"relative\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Enter your location\"\n                    value={searchLocation}\n                    onChange={(e) => setSearchLocation(e.target.value)}\n                    className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 text-sm\"\n                  />\n                  <i className=\"ri-map-pin-line absolute left-3 top-3.5 text-gray-400\"></i>\n                </div>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Blood Type</label>\n                <div className=\"relative\">\n                  <select\n                    value={selectedBloodType}\n                    onChange={(e) => setSelectedBloodType(e.target.value)}\n                    className=\"w-full pl-10 pr-8 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 text-sm appearance-none\"\n                  >\n                    <option value=\"\">All blood types</option>\n                    {bloodTypes.map((type) => (\n                      <option key={type} value={type}>{type}</option>\n                    ))}\n                  </select>\n                  <i className=\"ri-drop-line absolute left-3 top-3.5 text-gray-400\"></i>\n                </div>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Sort By</label>\n                <div className=\"relative\">\n                  <select\n                    value={sortBy}\n                    onChange={(e) => setSortBy(e.target.value)}\n                    className=\"w-full pl-10 pr-8 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 text-sm appearance-none\"\n                  >\n                    <option value=\"rating\">Select</option>\n                    <option value=\"availability\">Availability</option>\n                  </select>\n                  <i className=\"ri-sort-asc absolute left-3 top-3.5 text-gray-400\"></i>\n                </div>\n              </div>\n              \n              {/* <div className=\"flex items-end\">\n                <Button className=\"w-full\" size=\"lg\">\n                  <i className=\"ri-search-line mr-2\"></i>\n                  Search\n                </Button>\n              </div> */}\n            </div>\n          </Card>\n        </div>\n      </section>\n      \n      {/* Blood Banks List */}\n      <section className=\"py-8\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h2 className=\"text-2xl font-bold text-gray-900\">\n              {bloodBanks.length} Blood Banks Found\n            </h2>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredBanks.map((bank) => (\n              <Card key={bank.id} className=\"hover:shadow-lg transition-shadow duration-200\">\n                <div className=\"relative mb-4\">\n                  <img\n                    src={bloodBankImg}\n                    alt={bank.name}\n                    className=\"w-full h-48 object-cover object-top rounded-lg\"\n                  />\n                  <div className=\"absolute top-3 right-3\">\n                  </div>\n                </div>\n                \n                <div className=\"mb-4\">\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">{bank.name}</h3>\n                    <div className=\"flex items-center space-x-1\">\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-1 text-sm text-gray-600\">\n                    <p className=\"flex items-center\">\n                      <i className=\"ri-map-pin-line mr-2 text-gray-400\"></i>\n                      {bank.address}\n                    </p>\n                    <p className=\"flex items-center\">\n                      <i className=\"ri-mail-line mr-2 text-gray-400\"></i>\n                      {bank.contactEmail} \n                    </p>\n                    <p className=\"flex items-center\">\n                      <i className=\"ri-phone-line mr-2 text-gray-400\"></i>\n                      {bank.contactPhone}\n                    </p>\n                  </div>\n                </div>\n                \n                <div className=\"mb-4\">\n                  <h4 className=\"text-sm font-medium text-gray-700 mb-3\">Blood Availability</h4>\n                  <div className=\"grid grid-cols-4 gap-2\">\n                    {bank.availability && Object.entries(bank.availability).map(([type, val]: any) => {\n                      const stock = getStockLevel(val.quantity);\n                      return (\n                        <div key={type} className=\"text-center\">\n                          <Badge variant={stock.color as any} size=\"md\" >\n                            {type}\n                          </Badge>\n                          <div className=\"text-xs text-gray-500 mt-1\">{val.quantity} units</div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n                \n                <div className=\"flex justify-between items-center\">\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-sm text-gray-600\">\n                      <span className=\"font-medium\">From â‚¦{bank.amountPerPint}/pint</span>\n                    </div>\n                  </div>\n                  <Link to={`/blood-banks/${bank.id}`}>\n                    <Button size=\"sm\">\n                      View Details\n                    </Button>\n                  </Link>\n                </div>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n      \n      <Footer />\n    </div>\n  );\n}\n"],"names":["BloodBanks","searchLocation","setSearchLocation","useState","selectedBloodType","setSelectedBloodType","sortBy","setSortBy","filteredBanks","setFilteredBanks","bloodTypes","bloodBanks","setBloodBanks","useEffect","q","query","collection","db","where","snapshot","getDocs","banks","docSnap","bankData","invRef","invSnap","availability","lowestPrice","invDoc","data","type","filtered","bank","val","b","bCount","acc","aCount","getStockLevel","count","jsxs","jsx","Header","Card","e","bloodBankImg","stock","Badge","Link","Button","Footer"],"mappings":"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"}